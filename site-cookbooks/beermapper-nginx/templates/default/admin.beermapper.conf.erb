server {
  listen 443 ssl;
  server_name <%= @beermapper_admin_domain_name %>;
  access_log logs/beermapper.access.log;

  ssl on;
  ssl_certificate /etc/letsencrypt/current/<%= @beermapper_admin_domain_name %>/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/current/<%= @beermapper_admin_domain_name %>/key.pem;

  root <%= @server_root %>;
  passenger_enabled on;
  rails_env <%= @rails_env %>;
  charset utf-8;

  location ~ /.well-known/ {
    root <%= @server_root %>/<%= @beermapper_admin_domain_name %>;
  }

  include /opt/nginx/snippets/ssl-params.conf;
}

server {
  listen 443 ssl;
  server_name www.<%= @beermapper_admin_domain_name %>;
  rewrite ^(.*)$ https://<%= @beermapper_admin_domain_name %>$1;
}

server {
  listen 80;
  server_name www.<%= @beermapper_admin_domain_name %>;
  rewrite ^(.*)$ https://<%= @beermapper_admin_domain_name %>$1;
}

server {
  listen 80;
  server_name <%= @beermapper_admin_domain_name %>;
  rewrite ^(.*)$ https://<%= @beermapper_admin_domain_name %>$1;
}
